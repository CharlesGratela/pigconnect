import{e as L,z as j,p as _,r as y,o as l,b as p,a as r,j as $,l as F,H as I,f as o,w as s,n as x,G as P,c as B,u as M,k as S,t as w,i as g,F as C,d as D,g as n,C as V,Q as q}from"./app-DtuGJrLF.js";import{_ as A}from"./_plugin-vue_export-helper-DlAUqK2U.js";const H={class:"relative"},U={__name:"Dropdown",props:{align:{type:String,default:"right"},width:{type:String,default:"48"},contentClasses:{type:String,default:"py-1 bg-[#c58a61]"}},setup(d){const i=d,f=k=>{c.value&&k.key==="Escape"&&(c.value=!1)};L(()=>document.addEventListener("keydown",f)),j(()=>document.removeEventListener("keydown",f));const e=_(()=>({48:"w-48"})[i.width.toString()]),t=_(()=>i.align==="left"?"ltr:origin-top-left rtl:origin-top-right start-0":i.align==="right"?"ltr:origin-top-right rtl:origin-top-left end-0":"origin-top"),c=y(!1);return(k,b)=>(l(),p("div",H,[r("div",{onClick:b[0]||(b[0]=N=>c.value=!c.value)},[$(k.$slots,"trigger")]),F(r("div",{class:"fixed inset-0 z-40",onClick:b[1]||(b[1]=N=>c.value=!1)},null,512),[[I,c.value]]),o(P,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"opacity-0 scale-95","enter-to-class":"opacity-100 scale-100","leave-active-class":"transition ease-in duration-75","leave-from-class":"opacity-100 scale-100","leave-to-class":"opacity-0 scale-95"},{default:s(()=>[F(r("div",{class:x(["absolute z-50 mt-2 rounded-md shadow-lg",[e.value,t.value]]),style:{display:"none"},onClick:b[2]||(b[2]=N=>c.value=!1)},[r("div",{class:x(["rounded-md ring-1 ring-[#281c11] ring-opacity-5",d.contentClasses])},[$(k.$slots,"content")],2)],2),[[I,c.value]])]),_:3})]))}},T={__name:"DropdownLink",props:{href:{type:String,required:!0}},setup(d){return(i,f)=>(l(),B(M(S),{href:d.href,class:"block w-full px-4 py-2 text-start text-sm leading-5 text-[#543434] hover:bg-[#c58a61] focus:outline-none focus:bg-[#c58a61] transition duration-150 ease-in-out"},{default:s(()=>[$(i.$slots,"default")]),_:3},8,["href"]))}},h={__name:"NavLink",props:{href:{type:String,required:!0},active:{type:Boolean}},setup(d){const i=d,f=_(()=>i.active?"inline-flex items-center px-1 pt-1 border-b-2 border-[#c58a61] text-sm font-medium leading-5 text-[#543434] focus:outline-none focus:border-[#c58a61] transition duration-150 ease-in-out":"inline-flex items-center px-1 pt-1 border-b-2 border-transparent text-sm font-medium leading-5 text-[#543434] hover:text-[#a7674d] hover:border-[#c59461] focus:outline-none focus:text-[#a7674d] focus:border-[#c59461] transition duration-150 ease-in-out"),e=()=>{window.location.href=i.href};return(t,c)=>(l(),B(M(S),{href:d.href,class:x(f.value),onClick:e},{default:s(()=>[$(t.$slots,"default")]),_:3},8,["href","class"]))}},v={__name:"ResponsiveNavLink",props:{href:{type:String,required:!0},active:{type:Boolean}},setup(d){const i=d,f=_(()=>i.active?"block pl-3 pr-4 py-2 border-l-4 border-[#c58a61] text-base font-medium text-[#543434] bg-[#c58a61] focus:outline-none focus:text-[#a7674d] focus:bg-[#c58a61] focus:border-[#c58a61] transition duration-150 ease-in-out":"block pl-3 pr-4 py-2 border-l-4 border-transparent text-base font-medium text-[#543434] hover:text-[#a7674d] hover:bg-[#c59461] hover:border-[#c59461] focus:outline-none focus:text-[#a7674d] focus:bg-[#c59461] focus:border-[#c59461] transition duration-150 ease-in-out"),e=()=>{window.location.href=i.href};return(t,c)=>(l(),B(M(S),{href:d.href,class:x(f.value),onClick:e},{default:s(()=>[$(t.$slots,"default")]),_:3},8,["href","class"]))}},K={key:0,class:"fixed top-4 right-4 bg-[#281c11] text-white px-6 py-3 rounded-lg shadow-lg z-50 flex items-center space-x-3 animate-fade-in"},X={class:"relative"},G={key:0,class:"absolute -top-1 -right-1 bg-red-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs"},Q={key:0,class:"absolute right-0 mt-2 w-80 bg-white rounded-md shadow-lg py-1 z-50"},J={class:"max-h-60 overflow-y-auto"},W={key:0,class:"px-4 py-2 text-sm text-gray-500"},Y=["onClick"],Z={class:"flex items-start"},ee={class:"flex-1"},te={class:"text-sm font-medium text-[#543434]"},re={class:"text-sm text-gray-500 truncate"},se={class:"text-xs text-gray-400"},oe={key:0,class:"w-2 h-2 bg-blue-500 rounded-full"},ne={class:"px-4 py-2 border-t border-gray-200"},ae={__name:"MessageNotification",setup(d,{expose:i}){const f=y(!1),e=y([]),t=y(0),c=y(!1),k=y(""),b=y(0),N=()=>{f.value=!f.value},z=m=>{if(m.length>0){const a=m[0];k.value=`New message from ${a.sender}: ${a.message}`,c.value=!0,setTimeout(()=>{c.value=!1},5e3)}},E=async()=>{var m;try{console.log("Fetching notifications...");const a=await fetch("/api/messages/notifications",{headers:{Accept:"application/json","Content-Type":"application/json","X-CSRF-TOKEN":(m=document.querySelector('meta[name="csrf-token"]'))==null?void 0:m.getAttribute("content")}});if(a.ok){const u=await a.json();console.log("Received notifications:",u),u.unread_count>b.value&&z(u.notifications),e.value=u.notifications,t.value=u.unread_count,b.value=u.unread_count}else console.error("Failed to fetch notifications:",a.status)}catch(a){console.error("Error fetching notifications:",a)}},O=async m=>{var a;try{(await fetch(`/api/messages/${m.id}/read`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":(a=document.querySelector('meta[name="csrf-token"]'))==null?void 0:a.getAttribute("content")}})).ok&&(m.read=!0,t.value=Math.max(0,t.value-1),f.value=!1,V.visit(route("chat.index",{userId:m.sender_id})))}catch(u){console.error("Error marking notification as read:",u)}},R=m=>{f.value&&!m.target.closest(".relative")&&(f.value=!1)};return L(()=>{E(),document.addEventListener("click",R)}),j(()=>{document.removeEventListener("click",R)}),i({fetchNotifications:E}),(m,a)=>(l(),p("div",null,[c.value?(l(),p("div",K,[a[2]||(a[2]=r("svg",{class:"w-6 h-6 text-[#c58a61]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})],-1)),r("span",null,w(k.value),1),r("button",{onClick:a[0]||(a[0]=u=>c.value=!1),class:"text-white hover:text-[#c58a61]"},a[1]||(a[1]=[r("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))])):g("",!0),r("div",X,[r("button",{onClick:N,class:"inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-white bg-[#281c11] hover:text-[#a7674d] focus:outline-none transition ease-in-out duration-150"},[a[3]||(a[3]=r("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})],-1)),t.value>0?(l(),p("span",G,w(t.value),1)):g("",!0)]),f.value?(l(),p("div",Q,[a[5]||(a[5]=r("div",{class:"px-4 py-2 border-b border-gray-200"},[r("h3",{class:"text-sm font-semibold text-[#543434]"},"Messages")],-1)),r("div",J,[e.value.length===0?(l(),p("div",W," No new messages ")):(l(!0),p(C,{key:1},D(e.value,u=>(l(),p("div",{key:u.id,class:"px-4 py-2 hover:bg-gray-50 cursor-pointer",onClick:je=>O(u)},[r("div",Z,[r("div",ee,[r("p",te,w(u.sender),1),r("p",re,w(u.message),1),r("p",se,w(u.time),1)]),u.read?g("",!0):(l(),p("div",oe))])],8,Y))),128))]),r("div",ne,[o(M(S),{href:m.route("chat.list"),class:"text-sm text-[#c58a61] hover:text-[#a7674d] font-medium"},{default:s(()=>a[4]||(a[4]=[n(" View all messages ")])),_:1},8,["href"])])])):g("",!0)])]))}},ie=A(ae,[["__scopeId","data-v-f1ee04ef"]]),le={class:"min-h-screen"},ue={style:{"background-color":"#c58a61",padding:"15px 0"}},de={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},fe={class:"flex justify-between h-16"},ce={class:"flex"},pe={class:"shrink-0 flex items-center"},me={class:"text-white hidden space-x-8 sm:-my-px sm:ms-10 sm:flex"},he={class:"hidden sm:flex sm:items-center sm:ms-6"},ve={class:"ms-3 relative"},ge={class:"ms-3 relative"},be={class:"inline-flex rounded-md"},ye={type:"button",class:"inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-white bg-[#281c11] hover:text-[#a7674d] focus:outline-none transition ease-in-out duration-150"},we={class:"-me-2 flex items-center sm:hidden"},ke={class:"h-6 w-6",stroke:"currentColor",fill:"none",viewBox:"0 0 24 24"},xe={class:"pt-2 pb-3 space-y-1 text-white"},$e={class:"pt-4 pb-1 border-t border-[#c59461] text-white"},Ce={class:"px-4"},Me={class:"font-medium text-base text-white"},Se={class:"font-medium text-sm text-white"},Ne={class:"mt-3 space-y-1"},_e={key:0,class:"bg-white shadow"},Be={class:"max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8"},Le={computed:{redirectToPigFarmInformation(){return route("farmer.pigfarminformation")},dashboardRoute(){const d=this.$page.props.auth.user.role;return d==="farmer"?route("farmer.dashboard"):d==="buyer"?route("buyer.dashboard"):d==="admin"?route("admin.dashboard"):route("dashboard")}}},Fe=Object.assign(Le,{__name:"AuthenticatedLayout",setup(d){const i=y(!1);q();const f=()=>{const e=document.querySelector("message-notification");e&&e.fetchNotifications()};return L(()=>{const e=setInterval(f,3e3);j(()=>{clearInterval(e)})}),(e,t)=>(l(),p("div",null,[r("div",le,[r("nav",ue,[r("div",de,[r("div",fe,[r("div",ce,[r("div",pe,[o(M(S),{href:e.dashboardRoute},{default:s(()=>t[1]||(t[1]=[r("img",{src:"/images/favicon.png",alt:"Site Logo",class:"h-10"},null,-1)])),_:1},8,["href"])]),r("div",me,[o(h,{href:e.dashboardRoute,active:e.route().current(e.dashboardRoute)},{default:s(()=>t[2]||(t[2]=[n(" Dashboard ")])),_:1},8,["href","active"]),e.$page.props.auth.user.role=="farmer"?(l(),p(C,{key:0},[o(h,{href:e.route("farmer.pigfarminformation"),active:e.route().current("farmer.pigfarminformation")},{default:s(()=>t[3]||(t[3]=[n(" Farm Information ")])),_:1},8,["href","active"]),o(h,{href:e.route("pig.information"),active:e.route().current("pig.information")},{default:s(()=>t[4]||(t[4]=[n(" Pig Information ")])),_:1},8,["href","active"]),o(h,{href:e.route("farmer.expenses"),active:e.route().current("farmer.expenses")},{default:s(()=>t[5]||(t[5]=[n(" Expenses ")])),_:1},8,["href","active"]),o(h,{href:e.route("farmer.breedingrecord"),active:e.route().current("farmer.breedingrecord")},{default:s(()=>t[6]||(t[6]=[n(" Breeding Record ")])),_:1},8,["href","active"]),o(h,{href:e.route("farmer.feedingschedule"),active:e.route().current("farmer.feedingschedule")},{default:s(()=>t[7]||(t[7]=[n(" Feeding Schedule ")])),_:1},8,["href","active"]),o(h,{href:e.route("chat.list"),active:e.route().current("chat.list")},{default:s(()=>t[8]||(t[8]=[n(" Messages ")])),_:1},8,["href","active"])],64)):g("",!0),e.$page.props.auth.user.role=="admin"?(l(),B(h,{key:1,href:e.route("admin.users"),active:e.route().current("admin.users")},{default:s(()=>t[9]||(t[9]=[n(" User accounts ")])),_:1},8,["href","active"])):g("",!0),e.$page.props.auth.user.role=="buyer"?(l(),p(C,{key:2},[o(h,{href:e.route("buyer.preferences"),active:e.route().current("buyer.preferences")},{default:s(()=>t[10]||(t[10]=[n(" Preferences ")])),_:1},8,["href","active"]),o(h,{href:e.route("buyer.information"),active:e.route().current("buyer.information")},{default:s(()=>t[11]||(t[11]=[n(" Buyer Information ")])),_:1},8,["href","active"]),o(h,{href:e.route("chat.list"),active:e.route().current("chat.list")},{default:s(()=>t[12]||(t[12]=[n(" Messages ")])),_:1},8,["href","active"])],64)):g("",!0)])]),r("div",he,[r("div",ve,[o(ie)]),r("div",ge,[o(U,{align:"right",width:"48"},{trigger:s(()=>[r("span",be,[r("button",ye,[n(w(e.$page.props.auth.user.name)+" ",1),t[13]||(t[13]=r("svg",{class:"ms-2 -me-0.5 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[r("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1))])])]),content:s(()=>[o(T,{href:e.route("profile.edit")},{default:s(()=>t[14]||(t[14]=[n(" Profile ")])),_:1},8,["href"]),o(T,{href:e.route("logout"),method:"post",as:"button"},{default:s(()=>t[15]||(t[15]=[n(" Log Out ")])),_:1},8,["href"])]),_:1})])]),r("div",we,[r("button",{onClick:t[0]||(t[0]=c=>i.value=!i.value),class:"inline-flex items-center justify-center p-2 rounded-md text-white hover:text-[#a7674d] hover:bg-[#c59461] focus:outline-none focus:bg-[#c59461] focus:text-[#a7674d] transition duration-150 ease-in-out"},[(l(),p("svg",ke,[r("path",{class:x({hidden:i.value,"inline-flex":!i.value}),"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 12h16M4 18h16"},null,2),r("path",{class:x({hidden:!i.value,"inline-flex":i.value}),"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"},null,2)]))])])])]),r("div",{class:x([{block:i.value,hidden:!i.value},"sm:hidden"])},[r("div",xe,[e.$page.props.auth.user.role=="farmer"?(l(),p(C,{key:0},[o(v,{href:e.dashboardRoute,active:e.route().current(e.dashboardRoute)},{default:s(()=>t[16]||(t[16]=[n(" Home ")])),_:1},8,["href","active"]),o(v,{href:e.route("farmer.pigfarminformation"),active:e.route().current("farmer.pigfarminformation")},{default:s(()=>t[17]||(t[17]=[n(" Farm Information ")])),_:1},8,["href","active"]),o(v,{href:e.route("pig.information"),active:e.route().current("pig.information")},{default:s(()=>t[18]||(t[18]=[n(" Pig Information ")])),_:1},8,["href","active"]),o(v,{href:e.route("farmer.expenses"),active:e.route().current("farmer.expenses")},{default:s(()=>t[19]||(t[19]=[n(" Expenses ")])),_:1},8,["href","active"]),o(v,{href:e.route("farmer.breedingrecord"),active:e.route().current("farmer.breedingrecord")},{default:s(()=>t[20]||(t[20]=[n(" Breeding Record ")])),_:1},8,["href","active"]),o(v,{href:e.route("farmer.feedingschedule"),active:e.route().current("farmer.feedingschedule")},{default:s(()=>t[21]||(t[21]=[n(" Feeding Schedule ")])),_:1},8,["href","active"])],64)):g("",!0),e.$page.props.auth.user.role=="buyer"?(l(),p(C,{key:1},[o(v,{href:e.route("buyer.preferences"),active:e.route().current("buyer.preferences")},{default:s(()=>t[22]||(t[22]=[n(" Preferences ")])),_:1},8,["href","active"]),o(v,{href:e.route("buyer.information"),active:e.route().current("buyer.information")},{default:s(()=>t[23]||(t[23]=[n(" Buyer Information ")])),_:1},8,["href","active"])],64)):g("",!0),o(v,{href:e.route("chat.list"),active:e.route().current("chat.list")},{default:s(()=>t[24]||(t[24]=[n(" Messages ")])),_:1},8,["href","active"])]),r("div",$e,[r("div",Ce,[r("div",Me,w(e.$page.props.auth.user.name),1),r("div",Se,w(e.$page.props.auth.user.email),1)]),r("div",Ne,[o(v,{href:e.route("profile.edit")},{default:s(()=>t[25]||(t[25]=[n(" Profile ")])),_:1},8,["href"]),o(v,{href:e.route("logout.get"),as:"button"},{default:s(()=>t[26]||(t[26]=[n(" Log Out ")])),_:1},8,["href"])])])],2)]),e.$slots.header?(l(),p("header",_e,[r("div",Be,[$(e.$slots,"header")])])):g("",!0),r("main",null,[$(e.$slots,"default")])])]))}});export{Fe as _};
