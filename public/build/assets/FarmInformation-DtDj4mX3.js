import{r as f,x as h,e as F,y as E,b as T,f as j,w,o as A,a as o,h as S,l as m,s as b,v as P}from"./app-BBvVVKdH.js";import{_ as K}from"./AuthenticatedLayout-DUguJAC5.js";const N={class:"flex justify-center"},B={class:"w-[75%]"},C={class:"mb-4"},I={class:"mb-4"},U={class:"mb-4"},z={__name:"FarmInformation",setup(_){const g=f(""),u=f(0),t=h({lat:0,lng:0}),c=f("");let d,r;const p=async()=>{try{const n=await fetch("/api/pigfarminformation",{headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},credentials:"include"});if(!n.ok)throw new Error("Network response was not ok");const e=await n.json();console.log(e),e&&(g.value=e.feeding_type,u.value=e.frequency_of_feeding,t.lat=e.latitude,t.lng=e.longitude,r&&(r.setPosition({lat:t.lat,lng:t.lng}),d.setCenter({lat:t.lat,lng:t.lng})),await y(t.lat,t.lng))}catch(n){console.error("Error fetching farm information:",n)}},y=async(n,e)=>{const i=`https://maps.googleapis.com/maps/api/geocode/json?latlng=${n},${e}&key=AIzaSyAPE3z_ByaGmKAwUDjUPFP6ZEZyyWmKvTY`;try{const a=await fetch(i);if(!a.ok)throw new Error("Network response was not ok");const l=await a.json();console.log("Reverse Geocoding Result:",l),l.results&&l.results.length>0&&(c.value=l.results[0].formatted_address)}catch(a){console.error("Error performing reverse geocoding:",a)}},v=async n=>{const s=`https://maps.googleapis.com/maps/api/geocode/json?address=${encodeURIComponent(n)}&key=AIzaSyAPE3z_ByaGmKAwUDjUPFP6ZEZyyWmKvTY`;try{const i=await fetch(s);if(!i.ok)throw new Error("Network response was not ok");const a=await i.json();if(console.log("Geocoding Result:",a),a.results&&a.results.length>0){const l=a.results[0].geometry.location;t.lat=l.lat,t.lng=l.lng,r&&(r.setPosition({lat:t.lat,lng:t.lng}),d.setCenter({lat:t.lat,lng:t.lng}))}}catch(i){console.error("Error performing geocoding:",i)}},k=()=>{d=new google.maps.Map(document.getElementById("map"),{center:{lat:t.lat,lng:t.lng},zoom:13}),r=new google.maps.Marker({position:{lat:t.lat,lng:t.lng},map:d,draggable:!0}),google.maps.event.addListener(r,"dragend",async function(){const n=r.getPosition();t.lat=n.lat(),t.lng=n.lng(),d.setCenter({lat:t.lat,lng:t.lng}),await y(t.lat,t.lng)})},x=async()=>{try{const n=document.querySelector('meta[name="csrf-token"]').getAttribute("content"),e=await fetch("/api/pigfarminformation",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":n,Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({feedingType:g.value,frequencyOfFeeding:u.value,location:t,address:c.value})});if(!e.ok)throw new Error("Network response was not ok");const s=await e.json();console.log("Form submitted successfully:",s),await p(),window.location.reload()}catch(n){console.error("Error submitting form:",n)}};return F(()=>{p(),k()}),E(c,async n=>{n&&await v(n)}),(n,e)=>(A(),T("div",null,[j(K,null,{header:w(()=>e[3]||(e[3]=[o("h2",{class:"font-semibold text-xl text-[#543434] leading-tight"},"Farm Details",-1)])),default:w(()=>[o("main",null,[o("div",N,[o("div",B,[o("form",{onSubmit:S(x,["prevent"]),class:"place-content-center"},[e[8]||(e[8]=o("div",{class:"mb-4"},[o("label",{for:"location",class:"block text-sm font-medium text-[#543434]"},"Location"),o("div",{id:"map",class:"w-full h-64"})],-1)),o("div",C,[e[4]||(e[4]=o("label",{for:"address",class:"block text-sm font-medium text-[#543434]"},"Address",-1)),m(o("input",{type:"text",id:"address","onUpdate:modelValue":e[0]||(e[0]=s=>c.value=s),class:"mt-1 block w-full p-2.5 bg-[#c58a61] border border-[#c59461] text-[#543434] rounded-lg focus:ring-[#c58a61] focus:border-[#c58a61]"},null,512),[[b,c.value]])]),o("div",I,[e[6]||(e[6]=o("label",{for:"feedingType",class:"block text-sm font-medium text-[#543434]"},"Feeding Type",-1)),m(o("select",{id:"feedingType","onUpdate:modelValue":e[1]||(e[1]=s=>g.value=s),class:"mt-1 block w-full p-2.5 bg-[#c58a61] border border-[#c59461] text-[#543434] rounded-lg focus:ring-[#c58a61] focus:border-[#c58a61]"},e[5]||(e[5]=[o("option",{value:"feed"},"Feed",-1),o("option",{value:"natural"},"Natural",-1)]),512),[[P,g.value]])]),o("div",U,[e[7]||(e[7]=o("label",{for:"frequencyOfFeeding",class:"block text-sm font-medium text-[#543434]"},"Frequency of Feeding",-1)),m(o("input",{type:"text",id:"frequencyOfFeeding","onUpdate:modelValue":e[2]||(e[2]=s=>u.value=s),class:"mt-1 block w-full p-2.5 bg-[#c58a61] border border-[#c59461] text-[#543434] rounded-lg focus:ring-[#c58a61] focus:border-[#c58a61]"},null,512),[[b,u.value]])]),e[9]||(e[9]=o("button",{type:"submit",class:"w-full bg-[#281c11] text-white p-2.5 rounded-lg focus:ring-4 focus:ring-[#c58a61]"},"Submit",-1))],32)])])])]),_:1})]))}};export{z as default};
