import{x as y,r as b,e as h,y as k,b as v,f as x,w as u,o as E,a as n,h as j,l as A,s as B}from"./app-BpM4j1nk.js";import{_}from"./AuthenticatedLayout-oNoyUsz9.js";const P={class:"flex justify-center"},S={class:"w-[75%]"},I={class:"mb-4"},T={__name:"BuyerInformation",setup(K){const t=y({lat:0,lng:0}),c=b("");let d,a;const g=async()=>{try{const o=await fetch("/api/buyerinformation",{headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},credentials:"include"});if(!o.ok)throw new Error("Network response was not ok");const e=await o.json();console.log(e),e&&(t.lat=e.latitude,t.lng=e.longitude,a&&(a.setPosition({lat:t.lat,lng:t.lng}),d.setCenter({lat:t.lat,lng:t.lng})),await m(t.lat,t.lng))}catch(o){console.error("Error fetching buyer information:",o)}},m=async(o,e)=>{const i=`https://maps.googleapis.com/maps/api/geocode/json?latlng=${o},${e}&key=AIzaSyAPE3z_ByaGmKAwUDjUPFP6ZEZyyWmKvTY`;try{const s=await fetch(i);if(!s.ok)throw new Error("Network response was not ok");const r=await s.json();console.log("Reverse Geocoding Result:",r),r.results&&r.results.length>0&&(c.value=r.results[0].formatted_address)}catch(s){console.error("Error performing reverse geocoding:",s)}},p=async o=>{const l=`https://maps.googleapis.com/maps/api/geocode/json?address=${encodeURIComponent(o)}&key=AIzaSyAPE3z_ByaGmKAwUDjUPFP6ZEZyyWmKvTY`;try{const i=await fetch(l);if(!i.ok)throw new Error("Network response was not ok");const s=await i.json();if(console.log("Geocoding Result:",s),s.results&&s.results.length>0){const r=s.results[0].geometry.location;t.lat=r.lat,t.lng=r.lng,a&&(a.setPosition({lat:t.lat,lng:t.lng}),d.setCenter({lat:t.lat,lng:t.lng}))}}catch(i){console.error("Error performing geocoding:",i)}},f=()=>{d=new google.maps.Map(document.getElementById("map"),{center:{lat:t.lat,lng:t.lng},zoom:13}),a=new google.maps.Marker({position:{lat:t.lat,lng:t.lng},map:d,draggable:!0}),google.maps.event.addListener(a,"dragend",async function(){const o=a.getPosition();t.lat=o.lat(),t.lng=o.lng(),d.setCenter({lat:t.lat,lng:t.lng}),await m(t.lat,t.lng)})},w=async()=>{try{const o=document.querySelector('meta[name="csrf-token"]').getAttribute("content"),e=await fetch("api/buyerinformationstore",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":o,Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({location:t,address:c.value,latitude:t.lat,longitude:t.lng})});if(!e.ok)throw new Error("Network response was not ok");const l=await e.json();console.log("Form submitted successfully:",l),await g(),window.location.reload()}catch(o){console.error("Error submitting form:",o)}};return h(()=>{g(),f()}),k(c,async o=>{o&&await p(o)}),(o,e)=>(E(),v("div",null,[x(_,null,{header:u(()=>e[1]||(e[1]=[n("h2",{class:"font-semibold text-xl text-[#543434] leading-tight"},"Buyer Information",-1)])),default:u(()=>[n("main",null,[n("div",P,[n("div",S,[n("form",{onSubmit:j(w,["prevent"]),class:"place-content-center"},[e[3]||(e[3]=n("div",{class:"mb-4"},[n("label",{for:"location",class:"block text-sm font-medium text-[#543434]"},"Location"),n("div",{id:"map",class:"w-full h-64"})],-1)),n("div",I,[e[2]||(e[2]=n("label",{for:"address",class:"block text-sm font-medium text-[#543434]"},"Address",-1)),A(n("input",{type:"text",id:"address","onUpdate:modelValue":e[0]||(e[0]=l=>c.value=l),class:"mt-1 block w-full p-2.5 bg-[#c58a61] border border-[#c59461] text-[#543434] rounded-lg focus:ring-[#c58a61] focus:border-[#c58a61]"},null,512),[[B,c.value]])]),e[4]||(e[4]=n("button",{type:"submit",class:"w-full bg-[#281c11] text-white p-2.5 rounded-lg focus:ring-4 focus:ring-[#c58a61]"},"Submit",-1))],32)])])])]),_:1})]))}};export{T as default};
